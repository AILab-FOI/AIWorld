<html><head></head><body><dom-module id="signedin-server"><template><style include="shared-styles">:host{@apply (--layout-vertical);@apply (--layout-center);}div.row .box.dashboard{@apply (--layout-vertical);@apply (--layout-center);width:100%;height:150px;}</style><app-location route="{{route}}"></app-location><app-route route="{{route}}" pattern="/server" data="{{routeData}}" tail="{{subroute}}"></app-route><iron-ajax id="ajaxUpdateServer" on-response="_serverChangesMade"></iron-ajax><div class="row"><div class="box dashboard"><center><h2>New Players Details</h2></center><iron-form id="formNewPlayerDetails"><form><vaadin-text-field required="" value="{{serverData.serverConfig.newPlayerDetails.mapId}}" label="Map ID" name="mapid"></vaadin-text-field><vaadin-text-field required="" value="{{serverData.serverConfig.newPlayerDetails.x}}" label="Spawn position X" name="x"></vaadin-text-field><vaadin-text-field required="" value="{{serverData.serverConfig.newPlayerDetails.y}}" label="Spawn position Y" name="y"></vaadin-text-field><vaadin-button on-tap="_saveChanges">Save</vaadin-button></form></iron-form></div></div><div class="row"><div class="box leaderboard"><center><h2>Switches</h2></center><vaadin-button on-tap="_addSwitch">Add switch</vaadin-button><vaadin-grid style="width: 100%;" name="ordersbook" aria-label="Orders book" items="[[_switches]]" active-item="{{activeItem}}"><vaadin-grid-column resizable=""><template class="header"><vaadin-grid-filter aria-label="id" path="id" value="[[_filterid]]"><input placeholder="id" value="{{_filterid::input}}" focus-target=""></vaadin-grid-filter></template><template>{{item.id}} ({{item.name}})</template></vaadin-grid-column><vaadin-grid-column resizable=""><template class="header"><vaadin-grid-filter aria-label="type" path="type" value="[[_filtertype]]"><input placeholder="type" value="{{_filtertype::input}}" focus-target=""></vaadin-grid-filter></template><template>{{item.type}}</template></vaadin-grid-column><vaadin-grid-column resizable=""><template class="header"><vaadin-grid-filter aria-label="status" path="status" value="[[_filterStatus]]"><paper-dropdown-menu-multi label="Status" selections="[&quot;true&quot;,&quot;false&quot;]" maxdisplay="3" value="{{_filterStatus}}"></paper-dropdown-menu-multi></vaadin-grid-filter></template><template><select id="value" name="value" on-change="_changeSwitchValue" class="form-control"><option slot="filter" value$="{{item.value}}">{{item.value}}</option><option value="true">True</option><option value="false">False</option></select></template></vaadin-grid-column><vaadin-grid-column resizable="" flex-grow="0"><template class="header"><span></span></template><template><vaadin-button on-tap="_deleteSwitch">Delete</vaadin-button></template></vaadin-grid-column></vaadin-grid></div><div class="box registrations"><center><h2>Global Variables</h2></center><vaadin-button on-tap="_addVariable">Add variable</vaadin-button><vaadin-grid style="width: 100%;" name="ordersbook" aria-label="Orders book" items="[[_variables]]"><vaadin-grid-column resizable=""><template class="header"><span>ID</span></template><template>{{item.id}} ({{item.name}})</template></vaadin-grid-column><vaadin-grid-column resizable=""><template class="header"><span>Value</span></template><template>{{item.value}}</template></vaadin-grid-column><vaadin-grid-column resizable="" flex-grow="0"><template class="header"><span></span></template><template><vaadin-button on-tap="_deleteVariable">Delete</vaadin-button></template></vaadin-grid-column></vaadin-grid></div><div class="box registrations"><center><h2>Offline Maps</h2></center><vaadin-button on-tap="_addOfflineMap">Add offline map</vaadin-button><vaadin-grid style="width: 100%;" name="ordersbook" aria-label="Orders book" items="[[_maps]]"><vaadin-grid-column resizable=""><template class="header"><span>Map</span></template><template>{{item.realId}} ({{item.name}})</template></vaadin-grid-column><vaadin-grid-column resizable="" flex-grow="0"><template class="header"><span></span></template><template><vaadin-button on-tap="_deleteMap">Delete</vaadin-button></template></vaadin-grid-column></vaadin-grid></div></div><paper-dialog id="addSwitch"><h2>Add switch</h2><iron-form id="formAddSwitch"><form><vaadin-text-field required="" value="" label="Switch ID" name="switchid"></vaadin-text-field><span>Type: </span><select name="type"><option value="party">Party switch</option><option value="global">Global switch</option></select><br></form></iron-form><div class="buttons" style="padding: 0px !important;"><vaadin-button dialog-dismiss="">Cancel</vaadin-button><vaadin-button dialog-confirm="" on-tap="_addSwitch">Ok</vaadin-button></div></paper-dialog><paper-dialog id="addVariable"><h2>Add global variable</h2><iron-form id="formAddVariable"><form><vaadin-text-field required="" value="" label="Variable ID" name="variableid"></vaadin-text-field><vaadin-text-field required="" value="" label="Default value" name="variablevalue"></vaadin-text-field></form></iron-form><div class="buttons" style="padding: 0px !important;"><vaadin-button dialog-dismiss="">Cancel</vaadin-button><vaadin-button dialog-confirm="" on-tap="_addVariable">Ok</vaadin-button></div></paper-dialog><paper-dialog id="addOfflineMap"><h2>Add offline map</h2><iron-form id="formAddOfflinemap"><form><vaadin-text-field required="" value="" label="Map ID" name="mapid"></vaadin-text-field></form></iron-form><div class="buttons" style="padding: 0px !important;"><vaadin-button dialog-dismiss="">Cancel</vaadin-button><vaadin-button dialog-confirm="" on-tap="_addOfflineMap">Ok</vaadin-button></div></paper-dialog></template><script>var SignedInServer=function(_Polymer$Element){babelHelpers.inherits(SignedInServer,_Polymer$Element);function SignedInServer(){babelHelpers.classCallCheck(this,SignedInServer);return babelHelpers.possibleConstructorReturn(this,(SignedInServer.__proto__||Object.getPrototypeOf(SignedInServer)).apply(this,arguments))}babelHelpers.createClass(SignedInServer,[{key:"connectedCallback",value:function connectedCallback(){babelHelpers.get(SignedInServer.prototype.__proto__||Object.getPrototypeOf(SignedInServer.prototype),"connectedCallback",this).call(this);this._loadSwitches();this._loadOfflineMaps();this._loadVariables()}},{key:"_saveChanges",value:function _saveChanges(){var ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer"),form=Polymer.dom(this.root).querySelector("#formNewPlayerDetails").serializeForm();if(0>=(form.mapid.length||form.x.length||form.y.length))return this.dispatchEvent(new CustomEvent("show-modal",{bubbles:!0,composed:!0,detail:{title:"Error occured",message:"Please fill all the form correctly"}}));this.serverData.serverConfig.newPlayerDetails.mapId=parseInt(form.mapid);this.serverData.serverConfig.newPlayerDetails.x=parseInt(form.x);this.serverData.serverConfig.newPlayerDetails.y=parseInt(form.y);ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/newPlayerDetails";ironAjax.body=this.serverData.serverConfig.newPlayerDetails;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_loadVariables",value:function _loadVariables(){var gameDataLoaded=0<Object.keys(this.serverData.gameData).length?!0:!1,globalVariables=Object.keys(this.serverData.serverConfig.globalVariables).length;this._variables=[];for(var i=0,payload;i<globalVariables;i++){payload={id:Object.keys(this.serverData.serverConfig.globalVariables)[i],value:this.serverData.serverConfig.globalVariables[Object.keys(this.serverData.serverConfig.globalVariables)[i]]};if(gameDataLoaded&&this.serverData.gameData.System.variables[payload.id])payload.name=this.serverData.gameData.System.variables[payload.id];this.push("_variables",payload)}}},{key:"_addVariable",value:function _addVariable(){var paperDialog=Polymer.dom(this.root).querySelector("paper-dialog#addVariable"),form=Polymer.dom(this.root).querySelector("#formAddVariable").serializeForm(),ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer");if(!paperDialog.opened)return paperDialog.toggle();if(0>=(form.variableid.length||form.variablevalue.length))return this.dispatchEvent(new CustomEvent("show-modal",{bubbles:!0,composed:!0,detail:{title:"Error occured",message:"Please fill all the form correctly"}}));this.serverData.serverConfig.globalVariables[form.variableid]=parseInt(form.variablevalue);Polymer.dom(this.root).querySelector("#formAddVariable").children[0].reset();ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/globalVariables";ironAjax.body=this.serverData.serverConfig.globalVariables;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_deleteVariable",value:function _deleteVariable(e){var ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer"),selectedVariable=e.model.item;delete this.serverData.serverConfig.globalVariables[selectedVariable.id];ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/globalVariables";ironAjax.body=this.serverData.serverConfig.globalVariables;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_loadOfflineMaps",value:function _loadOfflineMaps(){var gameDataLoaded=0<Object.keys(this.serverData.gameData).length?!0:!1,offlineMaps=Object.keys(this.serverData.serverConfig.offlineMaps).length;this._maps=[];for(var i=0;i<offlineMaps;i++){var realId=parseInt(Object.keys(this.serverData.serverConfig.offlineMaps)[i].split("-")[1]),payload={id:Object.keys(this.serverData.serverConfig.offlineMaps)[i],realId:realId,value:this.serverData.serverConfig.offlineMaps[Object.keys(this.serverData.serverConfig.offlineMaps)[i]]};if(gameDataLoaded&&this.serverData.gameData.MapInfos[realId])payload.name=this.serverData.gameData.MapInfos[realId].name;this.push("_maps",payload)}}},{key:"_addOfflineMap",value:function _addOfflineMap(){var paperDialog=Polymer.dom(this.root).querySelector("paper-dialog#addOfflineMap"),form=Polymer.dom(this.root).querySelector("#formAddOfflinemap").serializeForm(),ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer");if(!paperDialog.opened)return paperDialog.toggle();if(0>=form.mapid.length)return this.dispatchEvent(new CustomEvent("show-modal",{bubbles:!0,composed:!0,detail:{title:"Error occured",message:"Please fill all the form correctly"}}));this.serverData.serverConfig.offlineMaps["map-"+form.mapid]=!0;Polymer.dom(this.root).querySelector("#formAddOfflinemap").children[0].reset();ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/offlineMaps";ironAjax.body=this.serverData.serverConfig.offlineMaps;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_deleteMap",value:function _deleteMap(e){var ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer"),selectedMap=e.model.item;delete this.serverData.serverConfig.offlineMaps[selectedMap.id];ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/offlineMaps";ironAjax.body=this.serverData.serverConfig.offlineMaps;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_loadSwitches",value:function _loadSwitches(){var gameDataLoaded=0<Object.keys(this.serverData.gameData).length?!0:!1,globalSwitches=Object.keys(this.serverData.serverConfig.globalSwitches).length,partySwitches=Object.keys(this.serverData.serverConfig.partySwitches).length;this._switches=[];for(var i=0,payload;i<globalSwitches;i++){payload={id:Object.keys(this.serverData.serverConfig.globalSwitches)[i],type:"global",value:this.serverData.serverConfig.globalSwitches[Object.keys(this.serverData.serverConfig.globalSwitches)[i]]};if(gameDataLoaded&&this.serverData.gameData.System.switches[payload.id])payload.name=this.serverData.gameData.System.switches[payload.id];this.push("_switches",payload)}for(var i=0,_payload;i<partySwitches;i++){_payload={id:Object.keys(this.serverData.serverConfig.partySwitches)[i],type:"party",value:this.serverData.serverConfig.partySwitches[Object.keys(this.serverData.serverConfig.partySwitches)[i]]};if(gameDataLoaded&&this.serverData.gameData.System.switches[_payload.id])_payload.name=this.serverData.gameData.System.switches[_payload.id];this.push("_switches",_payload)}}},{key:"_changeSwitchValue",value:function _changeSwitchValue(e){var ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer"),selectedSwitch=e.model.item,newValue="false"===e.path[0].value?!1:!0;if("global"===selectedSwitch.type)this.serverData.serverConfig.globalSwitches[selectedSwitch.id]=newValue;else this.serverData.serverConfig.partySwitches[selectedSwitch.id]=newValue;ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/".concat(selectedSwitch.type,"Switches");ironAjax.body="global"===selectedSwitch.type?this.serverData.serverConfig.globalSwitches:this.serverData.serverConfig.partySwitches;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_addSwitch",value:function _addSwitch(){var paperDialog=Polymer.dom(this.root).querySelector("paper-dialog#addSwitch"),form=Polymer.dom(this.root).querySelector("#formAddSwitch").serializeForm(),ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer");if(!paperDialog.opened)return paperDialog.toggle();if(0>=form.switchid.length)return this.dispatchEvent(new CustomEvent("show-modal",{bubbles:!0,composed:!0,detail:{title:"Error occured",message:"Please fill all the form correctly"}}));if("global"===form.type)this.serverData.serverConfig.globalSwitches[form.switchid]=!1;else this.serverData.serverConfig.partySwitches[form.switchid]=!1;Polymer.dom(this.root).querySelector("#formAddSwitch").children[0].reset();ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/".concat(form.type,"Switches");ironAjax.body="global"===form.type?this.serverData.serverConfig.globalSwitches:this.serverData.serverConfig.partySwitches;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_deleteSwitch",value:function _deleteSwitch(e){var ironAjax=Polymer.dom(this.root).querySelector("#ajaxUpdateServer"),selectedSwitch=e.model.item;if("global"===selectedSwitch.type)delete this.serverData.serverConfig.globalSwitches[selectedSwitch.id];else delete this.serverData.serverConfig.partySwitches[selectedSwitch.id];ironAjax.method="PATCH";ironAjax.headers={"X-Access-Token":this.authSession.token,"X-Socket-ID":window.socket.id};ironAjax.url=window.projectUrl+"/api/admin/server/".concat(selectedSwitch.type,"Switches");ironAjax.body="global"===selectedSwitch.type?this.serverData.serverConfig.globalSwitches:this.serverData.serverConfig.partySwitches;ironAjax.contentType="application/json";ironAjax.generateRequest()}},{key:"_serverChangesMade",value:function _serverChangesMade(){this.dispatchEvent(new CustomEvent("reload-server",{bubbles:!0,composed:!0}));this.dispatchEvent(new CustomEvent("show-modal",{bubbles:!0,composed:!0,detail:{title:"Action successful",message:"The action has been successfully registered by the server."}}))}},{key:"_logOut",value:function _logOut(){this.dispatchEvent(new CustomEvent("sign-out",{bubbles:!0,composed:!0}))}}],[{key:"is",get:function get(){return"signedin-server"}},{key:"properties",get:function get(){return{_leaderboard:{value:0}}}},{key:"observers",get:function get(){return["_loadSwitches(serverData)","_loadOfflineMaps(serverData)","_loadVariables(serverData)"]}}]);return SignedInServer}(Polymer.Element);window.customElements.define(SignedInServer.is,SignedInServer);</script></dom-module></body></html>